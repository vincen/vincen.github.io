---
layout: post
title: mysql all in one
categories: database
tags: mysql
---
# 卸载

mac上用dmg方式安装，没有卸载的工具，需要手动删除如下文件：

{% highlight sh %}
sudo rm /usr/local/mysql
sudo rm -rf /usr/local/mysql*
sudo rm -rf /Library/StartupItems/MySQLCOM
sudo rm -rf /Library/PreferencePanes/MySQL
# 这一项没有找到
vim /etc/hostconfig  (and removed the line MYSQLCOM=-YES-)
rm -rf ~/Library/PreferencePanes/MySQL
sudo rm -rf /Library/Receipts/mysql*
sudo rm -rf /Library/Receipts/MySQL*
# 这一项也没找到
sudo rm -rf /var/db/receipts/com.mysql.*
{% endhighlight %}

# 优化

[环境参照](http://fuqssi.com/000C/)，本机的mysql，内存占用400多M，只是自己的测试环境，可以修改一下参数，使内存降到100M以内。

| parameter                              | raw value | updated value |
| -------------------------------------- | --------- | ------------- |
| performance_schema_max_table_instances | 12500     | 1000          |
| table_open_cache                       | 2000      | 400           |
| table_definition_cache                 | 1400      | 256           |

# 问题解决

## 本地用MySQLWorkbench无法连接MySQL

通过命令行 mysql -h localhost -u root -p，可以正常连接mysql，但是workbench连接时提示：

```
Your connection attempt failed for user 'root' from your host to server at localhost:3306:   Host '::1' is not allowed to connect to this MySQL server
```

瞬间懵逼，之后百度10分钟。做了两个设置。workbench能正常连接mysql。

设置一：

```mysql
mysql>use mysql;
mysql>update user set host = '%' where user = 'root';
```

设置二：

```mysql
GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION;
```

