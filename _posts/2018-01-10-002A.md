---
layout: post
title: python 笔记
categories: server-side
tags: python
---

# Python 笔记

一直在使用python2.7版本，这次痛下决心把所有代码移植到3.x版本上，从头再复习一遍python。

## 前提

以下内容基于python3.6+



## 文件结构与字符编码

```python
#!/usr/local/bin python3
# -*- coding: utf-8 -*-
```

第一行注释是告诉Linux/OS X系统，这是一个Python可执行程序，Windows系统会忽略这个注释。因为*nix系统不是按照扩展名执行文件的。

第二行注释是告诉Python解释器，按照UTF-8编码读取源代码。

python3.x，默认使用Unicode编码。

python代码结束不用加`;`。

## 数据类型

### 整数

### 浮点数

### 字符串

字符串是以单引号`'`或双引号`"`括起来的任意文本。

`'''`/`"""`三个引号扩起来的文本可以换行。

在`r'`在引号前加r，是不转义字符串里边的`\`。

### 布尔值

True, False

布尔值的运算符是：`and`, `or`, `not`。

### None

### 字符

bytes类型的数据用带`b`前缀的单引号或双引号表示：

```python
x = b'ABC'
```

## 表达式

### 变量

变量在程序中就是用一个变量名表示了，变量名必须是大小写英文、数字和`_`的组合，且不能用数字开头。

### 运算符

```python
>>> 17 // 3  # floor devision discards the fractional part
5
>>> 5 ** 2  # 5 squared
25
```

## 输入输出与格式化文本

print() 输出函数

input() 输入函数

在Python中，采用的格式化方式和C语言是一致的，用`%`实现：

```python
>>> 'Hello, %s' % 'world'
'Hello, world'
>>> 'Hi, %s, you have $%d.' % ('Michael', 1000000)
'Hi, Michael, you have $1000000.'

```

有几个`%?`占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个`%?`，括号可以省略。常见的占位符有：

| 占位符  | 替换内容 |
| ---- | ---- |
| %d   | 整数   |
| %f   | 浮点数  |
| %s   | 字符串  |

## 控制流

### if

if…else… ,  if…elif…else...

### for

for…in...

### while

### break

### continue

### pass

pass 关键字什么也不做，就是为了不要留空。

```python
>>> while True:
...     pass  # Busy-wait for keyboard interrupt (Ctrl+C)
```

```python
>>> class MyEmptyClass:
...     pass			# This is commonly used for creating minimal classes
```

```python
>>> def initlog(*args):
...     pass   # Remember to implement this!
...
```

## 高级数据类型

### list

list的索引位置：

```python
>>> classmates = ['Michael', 'Bob', 'Tracy', 'Vincen']
#      索引            ±0       1       2         3
#     逆序索引         -4       -3      -2        -1
```

list里面的元素的数据类型也可以不同，比如：

```python
>>> L = ['Apple', 123, True]
```

list元素也可以是另一个list，比如：

```python
>>> s = ['python', 'java', ['asp', 'php'], 'scheme']
>>> len(s)
4
```

#### 常用函数

append(), insert(), len(), pop(), sort()

### tuple

tuple和list非常类似，但是tuple一旦初始化就不能修改。

```python
>>> classmates = ('Michael', 'Bob', 'Tracy')
```

只有1个元素的tuple定义时必须加一个逗号`,`，来消除歧义：

```python
>>> t = (1,)
>>> t
(1,)
```

### dict

```python
>>> d = {'Michael': 95, 'Bob': 75, 'Tracy': 85}
>>> d['Michael']
95
```

要避免key不存在的错误，有两种办法，一是通过`in`判断key是否存在：

```python
>>> 'Thomas' in d
False
```

二是通过dict提供的`get()`方法，如果key不存在，可以返回`None`，或者自己指定的value：

```python
>>> d.get('Thomas')
None
>>> d.get('Thomas', -1)
-1
```

要删除一个key，用`pop(key)`方法，对应的value也会从dict中删除：

```python
>>> d.pop('Bob')
75
>>> d
{'Michael': 95, 'Tracy': 85}
```

### set

要创建一个set，需要提供一个list作为输入集合，重复元素在set中自动被过滤

```python
>>> s = set([1, 2, 3])
>>> s
{1, 2, 3}
```

通过`add(key)`方法可以添加元素到set中，可以重复添加，但不会有效果：

```python
>>> s.add(4)
>>> s
{1, 2, 3, 4}
```

通过`remove(key)`方法可以删除元素：

```python
>>> s.remove(4)
>>> s
{1, 2, 3}
```

set可以看成数学意义上的无序和无重复元素的集合，因此，两个set可以做数学意义上的交集、并集等操作：

```python
>>> s1 = set([1, 2, 3])
>>> s2 = set([2, 3, 4])
>>> s1 & s2
{2, 3}
>>> s1 | s2
{1, 2, 3, 4}
```

## 函数

python使用def关键字定义函数。

python的可以返回多个值，但其实是一个tuple。

python不允许空函数，所以什么都不做的函数，必须写pass。

### 函数参数

如果不能按照默认位置传参，需要加上参数名。

### 默认参数

默认参数必须在可变参数之后。

这是一条最佳实践：默认参数必须指向不变对象！





## 常用函数

所有内置函数，参考：https://docs.python.org/3/library/functions.html

### 1 ord(), chr()

对于单个字符的编码，Python提供了`ord()`函数获取字符的整数表示，`chr()`函数把编码转换为对应的字符：

```python
>>> ord('A')
65
>>> ord('中')
20013
>>> chr(66)
'B'
>>> chr(25991)
'文'
```

### 2 encode(), decode()

以Unicode表示的`str`通过`encode()`方法可以编码为指定的`bytes`

```python
>>> 'ABC'.encode('ascii')
b'ABC'
>>> '中文'.encode('utf-8')
b'\xe4\xb8\xad\xe6\x96\x87'
```

如果我们从网络或磁盘上读取了字节流，那么读到的数据就是`bytes`。要把`bytes`变为`str`，就需要用`decode()`方法：

```python
>>> b'ABC'.decode('ascii')
'ABC'
>>> b'\xe4\xb8\xad\xe6\x96\x87'.decode('utf-8')
'中文'
```

如果`bytes`中只有一小部分无效的字节，可以传入`errors='ignore'`忽略错误的字节：

```python
>>> b'\xe4\xb8\xad\xff'.decode('utf-8', errors='ignore')
'中'
```

### 3 len()

计算`str`包含多少个字符，可以用`len()`函数：

```python
>>> len('ABC')
3
>>> len('中文')
2
```

如果换成`bytes`，`len()`函数就计算字节数：

```python
>>> len(b'ABC')
3
>>> len(b'\xe4\xb8\xad\xe6\x96\x87')
6
>>> len('中文'.encode('utf-8'))
6
```

### 4 format()

format()函数也是格式化字符串的方法，它会用传入的参数依次替换字符串内的占位符`{0}`、`{1}`……，不过这种方式写起来比%要麻烦得多：

```python
>>> 'Hello, {0}, 成绩提升了 {1:.1f}%'.format('小明', 17.125)
'Hello, 小明, 成绩提升了 17.1%'
```

### 5 range()

range()函数会产生一个等差数列，

```python
range(5)
   0, 1, 2, 3, 4
range(5, 10)
   5, 6, 7, 8, 9
range(0, 10, 3)
   0, 3, 6, 9
```